# Counting and sampling DLT histories
# Cedric Chauve, Yann Ponty, Michael Wallner, April 24, 2019.

1. DLTcount

This python program computes, for a given species tree, the number of
histories of a given size n in an evolutionary model (DL or DLT), and
samples histories.

The species tree can be given as a newick string or is a caterpillar
with a specified number of leaves, or is a complete binary tree of a
given height or is a random tree with a given size. The species tree
can be unranked (binary tree) or ranked; for a given tree, if ranked,
the provided species tree must be the corresponding unary-binary
tree. For trees generated by the program, the ranking is random.

The model can be DL (Duplication-Loss) or DLT
(Duplication-Loss-Transfer).

If the number of samples is 0, no history is samples and only the
number of histories is returned.

USAGE:

DLTcount <tree> <MODEL> <n> <number of samples>
tree = random k | rrandom k | caterpillar k | rcaterpillar k | complete h | rcomplete h | newick string
	random k = random binary tree with k leaves
	rrandom k = randomly ranked random binary tree with k leaves
	caterpillar k = caterpillar with k leaves
	rcaterpillar k = randomly ranked caterpillar with k leaves
	complete h = complete binary tree with 2^h leaves
	rcomplete h = randomly ranked complete binary tree with 2^h leaves
	newick string = string is the Newick representation of a tree
MODEL = DL | DLT
n = history size
number of samples = non-negative integer, number of sampled histories

Sampled histories are represented as vectors of evolutionary events:
ZX = Extant gene at species X
LX = Gene loss at species X
DX = Gene duplication at species X
TX->Y = HGT from species X to species Y

Example:
> python DLTcount.py rrandom 4 DLT 5 3
#Species tree: (((0)1)2,((3,4)5,(6)7)8)9
#Model: DLT
#History size: 5
Number of histories of size 5: 821804
Sampled history 1: ['D9', 'L2', 'D8', 'L3', 'Z4', 'L7', 'D5', 'Z3', 'L4', 'Z3', 'L4', 'L7', 'D9', 'Z0', 'L8', 'L2', 'L5', 'Z6']
Sampled history 2: ['D9', 'L2', 'L5', 'Z6', 'L2', 'D8', 'T3->0', 'T3->0', 'Z3', 'Z0', 'Z0', 'L4', 'L7', 'Z3', 'L4', 'L7']
Sampled history 3: ['L2', 'T5->1', 'L3', 'Z4', 'D1', 'T1->5', 'Z0', 'L3', 'Z4', 'T1->5', 'Z0', 'Z3', 'L4', 'L7']

2. DLTasymptotics <tree> <MODEL>

This python program computes, for a given species tree, the
asymptotics growth factor of the number of histories of a given size n
in an evolutionary model (DL or DLT), and samples histories.

The species tree can be given as a newick string or is a caterpillar
with a specified number of leaves, or is a complete binary tree of a
given height or is a random tree with a given size. The species tree
can be unranked (binary tree) or ranked; for a given tree, if ranked,
the provided species tree must be the corresponding unary-binary
tree. For trees generated by the program, the ranking is random.

The model can be DL (Duplication-Loss) or DLT
(Duplication-Loss-Transfer).

USAGE:

DLTasymptotics <tree> <MODEL>
tree = random k | rrandom k | caterpillar k | rcaterpillar k | complete h | rcomplete h | newick string
	random k = random binary tree with k leaves
	rrandom k = randomly ranked random binary tree with k leaves
	caterpillar k = caterpillar with k leaves
	rcaterpillar k = randomly ranked caterpillar with k leaves
	complete h = complete binary tree with 2^h leaves
	rcomplete h = randomly ranked complete binary tree with 2^h leaves
	newick string = string is the Newick representation of a tree
MODEL = DL | DLT

Example
> python DLTasymptotics.py newick '(0,(1,(2,(3,4)5)6)7)8' DL
(0,(1,(2,(3,4)5)6)7)8	30.527541446606055
> python DLTasymptotics.py newick '(0,(1,(2,(3,4)5)6)7)8' DLT
(0,(1,(2,(3,4)5)6)7)8	46.46904190465355

Warning: in the DLT model, solving the system can require a lot of
memory and time.